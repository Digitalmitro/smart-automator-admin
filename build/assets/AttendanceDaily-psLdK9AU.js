import{w,r as a,k as N,j as e}from"./index-_oFzRGsN.js";import{a as E}from"./logo-CSkKVHs_.js";import{u as d,w as v}from"./xlsx-Btx5Z9-G.js";import{Q as k}from"./ReactToastify-iM3XEq0i.js";import{h as m}from"./moment-C5S46NFB.js";import{C}from"./CCard-BXIBBHvo.js";import{m as i}from"./proxy-xutnNBsr.js";import{C as A}from"./CCardHeader-d4jxurG0.js";import"./clsx-B-dksMZM.js";var O={};const K=()=>{const{id:_}=w(),h=m().format("MMM Do YY");console.log(h);const[r,L]=a.useState(""),[M,S]=a.useState(!0);N();const[x,f]=a.useState([]),j=async()=>{const t=await E.get(`${O.REACT_APP_BACKEND_API}/attendance`);f(t.data)},u=x.filter(t=>t.currentDate===h);console.log(u);const l=Object.values(u.reduce((t,s)=>{const n=s.currentDate;return t[n]||(t[n]={currentDate:n,userName:"",userEmail:"",punchin:"",punchOut:"",time:"",status:"",ip:""}),s.userName&&(t[n].userName=s.userName),s.userEmail&&(t[n].userEmail=s.userEmail),s.punchin&&(t[n].punchin=s.punchin),s.punchOut&&(t[n].punchOut=s.punchOut),s.time&&(t[n].time=s.time),s.status&&(t[n].status=s.status),s.ip&&(t[n].ip=s.ip),t},{}));console.log(l);const[b,P]=a.useState(""),c=l.filter(t=>{var n;if(!((n=t.currentDate)!=null&&n.includes(b)))return!1;const s=m(r).format("MMM Do YY");return r&&t.currentDate===s?!0:!r});a.useEffect(()=>{j()},[]);const y=()=>{if(c.length===0){console.error("No data to download");return}const t=d.json_to_sheet(c),s=d.book_new();d.book_append_sheet(s,t,"Sheet1");const n=v(s,{bookType:"xlsx",type:"array"}),g=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=URL.createObjectURL(g),o=document.createElement("a");o.href=p,o.setAttribute("download","attendance.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(p)},D=c.filter(t=>t.status==="LATE").length;return e.jsx(e.Fragment,{children:e.jsx(C,{children:e.jsxs(i.div,{className:" main-container1 container  ",children:[e.jsx(k,{}),e.jsxs("div",{className:"container margin-container ",children:[e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsx(A,{children:e.jsx(i.h2,{className:" fw-bold ms-3",children:"Today's Attendace"})}),e.jsx(i.h1,{className:" fw-bold ms-3",children:e.jsxs("button",{className:"btn btn-success",onClick:y,children:[e.jsx("i",{class:"fa-solid fa-download"})," Attendance Data"]})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},children:[e.jsx("div",{style:{display:"flex",gap:"20px"}}),e.jsxs("p",{style:{fontWeight:"bold",border:"1px solid",padding:"10px",borderRadius:"10px",background:"orange",color:"white",textTransform:"uppercase"},children:["No. of Late: ",D]})]}),e.jsx(i.div,{className:"table-responsive  container",children:e.jsxs("table",{class:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Date"}),e.jsx("th",{scope:"col",children:"PunchIn"}),e.jsx("th",{scope:"col",children:"PunchOut"}),e.jsx("th",{scope:"col",children:"production"}),e.jsx("th",{scope:"col",children:"Status"}),e.jsx("th",{scope:"col",children:"IP Address"})]})}),e.jsx("tbody",{children:l.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.userName}),e.jsx("td",{children:t.userEmail}),e.jsx("td",{children:t.currentDate}),e.jsx("td",{children:t.punchin}),e.jsx("td",{children:t.punchOut}),e.jsx("td",{children:t.time}),e.jsx("td",{style:{color:t.status==="LATE"?"red":"green"},children:t.status}),e.jsx("td",{children:t.ip})]},s))})]})})]})]})})})};export{K as default};
