import{w as v,r as o,k,j as e}from"./index-Cb6zMgq2.js";import{b as D}from"./logo-0TUeJTsT.js";import{u as d,w as j}from"./xlsx-YQvpTstd.js";import{Q as E}from"./ReactToastify-BBw959Jj.js";import{h as _}from"./moment-C5S46NFB.js";import{C as S}from"./CCard-Dhvwf52-.js";import{m as r}from"./proxy-DfvZMOWR.js";import{C}from"./CCardHeader-ed528WD5.js";import"./clsx-B-dksMZM.js";var U={NVM_INC:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/include/node",TERM_PROGRAM:"vscode",NODE:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/bin/node",INIT_CWD:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin",NVM_CD_FLAGS:"-q",TERM:"xterm-256color",SHELL:"/bin/zsh",npm_config_metrics_registry:"https://registry.npmjs.org/",HOMEBREW_REPOSITORY:"/opt/homebrew",TMPDIR:"/var/folders/ql/jd0xszm140z52480mgn4sph40000gn/T/",npm_config_global_prefix:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1",TERM_PROGRAM_VERSION:"1.68.0",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",COLOR:"1",npm_config_noproxy:"",npm_config_local_prefix:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin",NVM_DIR:"/Users/sayaksengupta/.nvm",USER:"sayaksengupta",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.9TW410B9YU/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/lib/node_modules/npm/bin/npm-cli.js",PATH:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin/node_modules/.bin:/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/node_modules/.bin:/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/node_modules/.bin:/Users/sayaksengupta/Desktop/DigitalMitro/node_modules/.bin:/Users/sayaksengupta/Desktop/node_modules/.bin:/Users/sayaksengupta/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/sayaksengupta/.nvm/versions/node/v20.5.1/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/opt/homebrew/opt/openjdk@17/bin:/Users/sayaksengupta/.nvm/versions/node/v20.5.1/bin:/Library/Frameworks/Python.framework/Versions/3.12/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/opt/homebrew/opt/openjdk@17/bin:/Users/sayaksengupta/.nvm/versions/node/v20.5.1/bin:/Library/Frameworks/Python.framework/Versions/3.12/bin:/Users/sayaksengupta/development/flutter/bin:/Users/sayaksengupta/mongodb-macos-aarch64-7.0.12/bin:/Users/sayaksengupta/development/flutter/bin:/Users/sayaksengupta/mongodb-macos-aarch64-7.0.12/bin",npm_package_json:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin/package.json",_:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin/node_modules/.bin/vite",npm_config_userconfig:"/Users/sayaksengupta/.npmrc",npm_config_init_module:"/Users/sayaksengupta/.npm-init.js",__CFBundleIdentifier:"com.microsoft.VSCode",npm_command:"run-script",PWD:"/Users/sayaksengupta/Desktop/DigitalMitro/Smart Automator/Smart Automator Admin/smart-automator-admin",JAVA_HOME:"/opt/homebrew/opt/openjdk@17",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"@coreui/coreui-free-react-admin-template",LANG:"en_GB.UTF-8",npm_config_npm_version:"9.8.0",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"--ms-enable-electron-run-as-node",XPC_FLAGS:"0x0",npm_config_node_gyp:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"5.0.0",XPC_SERVICE_NAME:"0",SHLVL:"2",HOME:"/Users/sayaksengupta",VSCODE_GIT_ASKPASS_MAIN:"/private/var/folders/ql/jd0xszm140z52480mgn4sph40000gn/T/AppTranslocation/1FEBBF32-087D-40AA-9BA4-F4246D629BDD/d/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js",HOMEBREW_PREFIX:"/opt/homebrew",npm_config_cache:"/Users/sayaksengupta/.npm",LOGNAME:"sayaksengupta",npm_lifecycle_script:"vite build",VSCODE_GIT_IPC_HANDLE:"/var/folders/ql/jd0xszm140z52480mgn4sph40000gn/T/vscode-git-30aa27c3a1.sock",NVM_BIN:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/bin",npm_config_user_agent:"npm/9.8.0 node/v20.5.1 darwin arm64 workspaces/false",GIT_ASKPASS:"/private/var/folders/ql/jd0xszm140z52480mgn4sph40000gn/T/AppTranslocation/1FEBBF32-087D-40AA-9BA4-F4246D629BDD/d/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh",VSCODE_GIT_ASKPASS_NODE:"/private/var/folders/ql/jd0xszm140z52480mgn4sph40000gn/T/AppTranslocation/1FEBBF32-087D-40AA-9BA4-F4246D629BDD/d/Visual Studio Code.app/Contents/Frameworks/Code Helper.app/Contents/MacOS/Code Helper",INFOPATH:"/opt/homebrew/share/info:/opt/homebrew/share/info:",HOMEBREW_CELLAR:"/opt/homebrew/Cellar",npm_node_execpath:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1/bin/node",npm_config_prefix:"/Users/sayaksengupta/.nvm/versions/node/v20.5.1",COLORTERM:"truecolor",NODE_ENV:"production",REACT_APP_BACKEND_API:"https://api.smartautomator.com"};const V=()=>{v();const l=_().format("MMM Do YY");console.log(l);const[i,N]=o.useState("");o.useState(!0),k();const[g,h]=o.useState([]),b=async()=>{const s=await D.get(`${U.REACT_APP_BACKEND_API}/attendance`);h(s.data)},c=g.filter(s=>s.currentDate===l);console.log(c);const p=Object.values(c.reduce((s,t)=>{const n=t.currentDate;return s[n]||(s[n]={currentDate:n,userName:"",userEmail:"",punchin:"",punchOut:"",time:"",status:"",ip:""}),t.userName&&(s[n].userName=t.userName),t.userEmail&&(s[n].userEmail=t.userEmail),t.punchin&&(s[n].punchin=t.punchin),t.punchOut&&(s[n].punchOut=t.punchOut),t.time&&(s[n].time=t.time),t.status&&(s[n].status=t.status),t.ip&&(s[n].ip=t.ip),s},{}));console.log(p);const[f,M]=o.useState(""),m=p.filter(s=>{var n;if(!((n=s.currentDate)!=null&&n.includes(f)))return!1;const t=_(i).format("MMM Do YY");return i&&s.currentDate===t?!0:!i});o.useEffect(()=>{b()},[]);const x=()=>{if(m.length===0){console.error("No data to download");return}const s=d.json_to_sheet(m),t=d.book_new();d.book_append_sheet(t,s,"Sheet1");const n=j(t,{bookType:"xlsx",type:"array"}),A=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=URL.createObjectURL(A),a=document.createElement("a");a.href=u,a.setAttribute("download","attendance.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(u)},y=m.filter(s=>s.status==="LATE").length;return e.jsx(e.Fragment,{children:e.jsx(S,{children:e.jsxs(r.div,{className:" main-container1 container  ",children:[e.jsx(E,{}),e.jsxs("div",{className:"container margin-container ",children:[e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsx(C,{children:e.jsx(r.h2,{className:" fw-bold ms-3",children:"Today's Attendace"})}),e.jsx(r.h1,{className:" fw-bold ms-3",children:e.jsxs("button",{className:"btn btn-success",onClick:x,children:[e.jsx("i",{class:"fa-solid fa-download"})," Attendance Data"]})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},children:[e.jsx("div",{style:{display:"flex",gap:"20px"}}),e.jsxs("p",{style:{fontWeight:"bold",border:"1px solid",padding:"10px",borderRadius:"10px",background:"orange",color:"white",textTransform:"uppercase"},children:["No. of Late: ",y]})]}),e.jsx(r.div,{className:"table-responsive  container",children:e.jsxs("table",{class:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Date"}),e.jsx("th",{scope:"col",children:"PunchIn"}),e.jsx("th",{scope:"col",children:"PunchOut"}),e.jsx("th",{scope:"col",children:"production"}),e.jsx("th",{scope:"col",children:"Status"}),e.jsx("th",{scope:"col",children:"IP Address"})]})}),e.jsx("tbody",{children:p.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.userName}),e.jsx("td",{children:s.userEmail}),e.jsx("td",{children:s.currentDate}),e.jsx("td",{children:s.punchin}),e.jsx("td",{children:s.punchOut}),e.jsx("td",{children:s.time}),e.jsx("td",{style:{color:s.status==="LATE"?"red":"green"},children:s.status}),e.jsx("td",{children:s.ip})]},t))})]})})]})]})})})};export{V as default};
