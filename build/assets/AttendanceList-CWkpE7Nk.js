import{w,r as a,k as C,j as e}from"./index-_oFzRGsN.js";import{a as D}from"./logo-CSkKVHs_.js";import{u as c,w as E}from"./xlsx-Btx5Z9-G.js";import{Q as _}from"./ReactToastify-iM3XEq0i.js";import{h as k}from"./moment-C5S46NFB.js";import{C as O}from"./CCard-BXIBBHvo.js";import{m as l}from"./proxy-xutnNBsr.js";import{C as M}from"./CCardHeader-d4jxurG0.js";import"./clsx-B-dksMZM.js";var p={};const Y=()=>{const{id:u}=w(),[r,x]=a.useState(""),[S,P]=a.useState(!0);C();const[m,j]=a.useState([]);console.log(p.REACT_APP_BACKEND_API);const f=async()=>{const t=await D.get(`${p.REACT_APP_BACKEND_API}/attendance/${u}`);j(t.data.attendance)},d=Object.values(m.reduce((t,s)=>{const n=s.currentDate;return t[n]||(t[n]={currentDate:n,userName:"",userEmail:"",punchin:"",punchOut:"",time:"",status:"",ip:""}),s.userName&&(t[n].userName=s.userName),s.userEmail&&(t[n].userEmail=s.userEmail),s.punchin&&(t[n].punchin=s.punchin),s.punchOut&&(t[n].punchOut=s.punchOut),s.time&&(t[n].time=s.time),s.status&&(t[n].status=s.status),s.ip&&(t[n].ip=s.ip),console.log("acc[currentDate]:",t[n]),t},{}));console.log(d);const[v,b]=a.useState(""),g=t=>{b(t.target.value)},i=d.filter(t=>{if(!t.currentDate.includes(v))return!1;const s=k(r).format("MMM Do YY");return r&&t.currentDate===s?!0:!r});a.useEffect(()=>{f()},[]);const y=()=>{if(i.length===0){console.error("No data to download");return}const t=c.json_to_sheet(i),s=c.book_new();c.book_append_sheet(s,t,"Sheet1");const n=E(s,{bookType:"xlsx",type:"array"}),N=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),h=URL.createObjectURL(N),o=document.createElement("a");o.href=h,o.setAttribute("download","attendance.xlsx"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(h)},A=i.filter(t=>t.status==="LATE").length;return e.jsx(e.Fragment,{children:e.jsx(O,{children:e.jsxs(l.div,{className:" main-container1 container  ",children:[e.jsx(_,{}),e.jsxs("div",{className:"container margin-container ",children:[e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsx(M,{children:e.jsx(l.h2,{className:" fw-bold ms-3",children:"Attendance Activities"})}),e.jsx(l.h1,{className:" fw-bold ms-3",children:e.jsxs("button",{className:"btn btn-success",onClick:y,children:[e.jsx("i",{class:"fa-solid fa-download"})," Attendance Data"]})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"10px"},children:[e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsxs("select",{style:{width:"130px",height:"45px"},onChange:g,children:[e.jsx("option",{value:"",children:"Select Month"}),e.jsx("option",{value:"Jan",children:"Jan"}),e.jsx("option",{value:"Feb",children:"Feb"}),e.jsx("option",{value:"Mar",children:"Mar"}),e.jsx("option",{value:"Apr",children:"Apr"}),e.jsx("option",{value:"May",children:"May"}),e.jsx("option",{value:"Jun",children:"Jun"}),e.jsx("option",{value:"July",children:"July"}),e.jsx("option",{value:"Aug",children:"Aug"}),e.jsx("option",{value:"Sep",children:"Sep"}),e.jsx("option",{value:"Oct",children:"Oct"}),e.jsx("option",{value:"Nov",children:"Nov"}),e.jsx("option",{value:"Dec",children:"Dec"})]}),e.jsx("input",{onChange:t=>x(t.target.value),style:{width:"130px",height:"45px"},type:"date"})]}),e.jsxs("p",{style:{fontWeight:"bold",border:"1px solid",padding:"10px",borderRadius:"10px",background:"orange",color:"white",textTransform:"uppercase"},children:["No. of Late: ",A]})]}),e.jsx(l.div,{className:"table-responsive  container",children:e.jsxs("table",{class:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"Email"}),e.jsx("th",{scope:"col",children:"Date"}),e.jsx("th",{scope:"col",children:"PunchIn"}),e.jsx("th",{scope:"col",children:"PunchOut"}),e.jsx("th",{scope:"col",children:"production"}),e.jsx("th",{scope:"col",children:"Status"}),e.jsx("th",{scope:"col",children:"IP Address"})]})}),e.jsx("tbody",{children:i.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.userName}),e.jsx("td",{children:t.userEmail}),e.jsx("td",{children:t.currentDate}),e.jsx("td",{children:t.punchin}),e.jsx("td",{children:t.punchOut}),e.jsx("td",{children:t.time}),e.jsx("td",{style:{color:t.status==="LATE"?"red":"green"},children:t.status}),e.jsx("td",{children:t.ip})]},t._id))})]})})]})]})})})};export{Y as default};
